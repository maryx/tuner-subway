function updateNotes(){for(var e=document.querySelectorAll(".n"),t=e.length,n=0;n<Math.max(ct.f.length,t);n++){var a;n>=t?a=document.createElement("div"):(a=e[n],a.style.display=""),n>=ct.f.length&&(a.style.display="none"),a.setAttribute("class","n "+COLORS[ct.n[n]]),a.innerHTML=ct.n[n],n>=t&&document.getElementById("ns").appendChild(a)}}function addTuners(){var e=document.createElement("h3");e.innerText="Press above notes or keyboard number keys, starting at 1",document.body.appendChild(e);var t=document.createElement("h3");t.innerText="Other tuners: ",document.body.appendChild(t);for(var n=0;n<TUNERS.length;n++){var a=document.createElement("div");a.setAttribute("class","t "+COLORS[TUNERS[n]]),a.innerText=TUNERS[n],t.appendChild(a)}}function addListeners(e,t){var n=document.querySelectorAll(".n");document.onkeydown=function(a){var o=a.keyCode-KEY_OFFSET;if(o>-1&&o<ct.f.length){clearAudio(t,e);try{e=playSyntheticNote(t,o)}catch(a){playFallbackNote(a)}n[o].classList.add("ac")}},document.onkeyup=function(e){var t=e.keyCode-KEY_OFFSET;t>-1&&t<ct.f.length&&n[t].classList.remove("ac")},n.forEach(function(n,a){n.addEventListener("mousedown",function(n){clearAudio(t,e);try{e=playSyntheticNote(t,a)}catch(n){playFallbackNote(n)}},!1)})}function clearAudio(e,t){e&&null!==e&&(e.stop(),e=null),t&&null!==t&&"closed"!==t.state&&t.close().then(function(){t=null})}function playSyntheticNote(e,t){aud=new AudioContext;var n=3e4*ct.c[t],a=aud.createBuffer(CHANNELS,n,90*ct.f[t]);return createSource(n,a,function(e){return e}),createSource(n,a,function(e){return Math.floor(e)/2}),aud}function createSource(e,t,n){source=aud.createBufferSource();for(var a=0;CHANNELS>a;a++)for(var o=t.getChannelData(a),c=0;e>c;c++){var r=0;e>e/10&&(r=c/e);var s=(e-c)/e;o[c]=n(Math.sin(c*Math.PI/90))*r*s}source.buffer=t,source.connect(aud.destination),source.start(0)}function playFallbackNote(e){console.error(e);var t=document.getElementById("p");ct.m&&t.setAttribute("src",ct.mp3[keyIndex]+".mp3")}var CONFIG={E:{s:"Standard E Station / The Wall Street",c:[1,1.2,1.6,2,2.8,3.6],f:[329.628,440,587.33,783.991,987.767,1318.51],n:["E","A","D","G","B","E"],m:["E","A","D","G","B","E2"]},D:{s:"Downtown D / Rocker Fellows Center",c:[1,1.2,1.6,2,2.8,3.6],f:[293.665,440,587.33,783.991,987.767,1318.51],n:["D","A","D","G","B","E"]},B:{s:"Bass Phish Park",c:[.4,.5,.6,.7],f:[164.814,220,293.665,391.995],n:["E","A","D","G"]},1:{s:"Siren Charms Hall / Drop A# Avenue",c:[1,1.2,1.6,2,2.8,3.6],f:[233.082,349.228,466.164,622.254,783.991,1046.5],n:['A<span class="h">#</span>',"F",'A<span class="h">#</span>','D<span class="h">#</span>',"G","C"]},G:{s:"Banjo Blue Grass Garden",c:[2.2,.6,.8,1.2,1.8],f:[391.995,146.832,195.998,246.942,293.665],n:["G","D","G","B","D"]},V:{s:"Violin Bridge / Grand Fiddle Junction",c:[1,1.6,2.8,3.6],f:[195.998,293.665,440,659.255],n:["G","D","A","E"]},U:{s:"Ukulele Circle Beach-by-the-Sea",c:[1.4,1,1.2,1.5],f:[391.995,261.626,329.628,440],n:["G","C","E","A"]}},KEY_OFFSET=49,CHANNELS=2,COLORS={1:"g",A:"",'A<span class="h">#</span>':"r",B:"o",C:"",D:"o",'D<span class="h">#</span>':"r",E:"",F:"o",G:"g",V:"r",U:"r"},TUNERS=["E","D","B","1","G","V","U"],ct=CONFIG.E;document.addEventListener("DOMContentLoaded",function(e){window.AudioContext=window.AudioContext||window.webkitAudioContext;var t,n;updateNotes(),addTuners(),addListeners(t,n);var a=document.querySelectorAll(".t");a.forEach(function(e,t){e.addEventListener("mousedown",function(e){ct=CONFIG[TUNERS[t]],document.getElementById("s").innerText=ct.s,updateNotes()},!1)})});
